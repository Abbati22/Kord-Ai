const a0_0xbffaa1=a0_0x1ba5;(function(_0x49983d,_0x3a0337){const _0xf3393e=a0_0x1ba5,_0x4a2416=_0x49983d();while(!![]){try{const _0x3d25c1=-parseInt(_0xf3393e(0x1f9))/0x1*(parseInt(_0xf3393e(0x1f8))/0x2)+-parseInt(_0xf3393e(0x1ee))/0x3+-parseInt(_0xf3393e(0x1f3))/0x4*(parseInt(_0xf3393e(0x1e0))/0x5)+parseInt(_0xf3393e(0x1ec))/0x6+parseInt(_0xf3393e(0x1f0))/0x7*(parseInt(_0xf3393e(0x1ed))/0x8)+parseInt(_0xf3393e(0x1ef))/0x9*(-parseInt(_0xf3393e(0x1db))/0xa)+-parseInt(_0xf3393e(0x1d7))/0xb*(-parseInt(_0xf3393e(0x1e6))/0xc);if(_0x3d25c1===_0x3a0337)break;else _0x4a2416['push'](_0x4a2416['shift']());}catch(_0x3a69b3){_0x4a2416['push'](_0x4a2416['shift']());}}}(a0_0x23ca,0xcc48d));function a0_0x23ca(){const _0x307986=['cleanupExpiredButtons','emit','removeListener','handleButtonClick','9176VxHdoP','283WqOxhk','selectedId','templateButtonReplyMessage','error','set','activeButtons','44806058ietsID','destroy','now','clear','11628610WIXHGo','buttonsResponseMessage','cleanupInterval','exports','nativeFlowResponseMessage','3119250mCcWtR','Error\x20in\x20message\x20handler:','buttonHandler','BUTTON\x20HANDLER:\x20Message\x20received','type','events','12XUGcTa','message','removeAllListeners','registerButton','selectedButtonId','Error\x20handling\x20button\x20click:','6095136jidELk','8730296gETmeI','4904121aLYwKF','9nSdrDh','7WhYoSm','interactiveResponseMessage','log','8UeuQqP'];a0_0x23ca=function(){return _0x307986;};return a0_0x23ca();}const EventEmitter=require(a0_0xbffaa1(0x1e5));function a0_0x1ba5(_0x45479f,_0x49dbfe){const _0x23ca00=a0_0x23ca();return a0_0x1ba5=function(_0x1ba5c5,_0x4f58dd){_0x1ba5c5=_0x1ba5c5-0x1d4;let _0x16b0ae=_0x23ca00[_0x1ba5c5];return _0x16b0ae;},a0_0x1ba5(_0x45479f,_0x49dbfe);}class ButtonHandler extends EventEmitter{constructor(){const _0x887c1e=a0_0xbffaa1;super(),this[_0x887c1e(0x1d6)]=new Map(),this['cleanupInterval']=setInterval(()=>this['cleanupExpiredButtons'](),0x5*0x3c*0x3e8);}async[a0_0xbffaa1(0x1e9)](_0x218042,_0x2298a2,_0x23fa8c=0x1e*0x3c*0x3e8){const _0x2cc0af=a0_0xbffaa1;this[_0x2cc0af(0x1d6)][_0x2cc0af(0x1d5)](_0x218042,{'sessionId':_0x2298a2,'expiryTime':Date[_0x2cc0af(0x1d9)]()+_0x23fa8c});}async[a0_0xbffaa1(0x1f7)](_0x20b69c,_0x1f74cc){const _0x20462a=a0_0xbffaa1;console[_0x20462a(0x1f2)]('BUTTON\x20HANDLER:\x20Attempting\x20to\x20handle\x20button');try{if(!_0x1f74cc['message']?.[_0x20462a(0x1dc)]&&!_0x1f74cc[_0x20462a(0x1e7)]?.[_0x20462a(0x1fb)]&&!_0x1f74cc[_0x20462a(0x1e7)]?.[_0x20462a(0x1f1)])return![];let _0x479a67,_0x5986eb;console[_0x20462a(0x1f2)](_0x479a67),console[_0x20462a(0x1f2)](_0x5986eb);if(_0x1f74cc[_0x20462a(0x1e7)]['buttonsResponseMessage'])_0x479a67=_0x1f74cc['message'][_0x20462a(0x1dc)]['selectedButtonId'];else{if(_0x1f74cc['message'][_0x20462a(0x1fb)])_0x479a67=_0x1f74cc['message']['templateButtonReplyMessage'][_0x20462a(0x1fa)];else{if(_0x1f74cc['message'][_0x20462a(0x1f1)]){const _0x4a102e=_0x1f74cc[_0x20462a(0x1e7)][_0x20462a(0x1f1)];if(_0x4a102e['nativeFlowResponseMessage']?.[_0x20462a(0x1ea)])try{_0x5986eb=JSON['parse'](_0x4a102e[_0x20462a(0x1df)][_0x20462a(0x1ea)]),console['log'](_0x5986eb),_0x479a67=_0x5986eb['id'],console['log'](_0x479a67);}catch(_0x3d3db6){return console[_0x20462a(0x1d4)]('Error\x20parsing\x20button\x20data:',_0x3d3db6),![];}}}}if(!_0x479a67)return![];const _0x253276=this[_0x20462a(0x1d6)]['get'](_0x479a67);return this[_0x20462a(0x1f5)](_0x479a67,{..._0x5986eb,'message':_0x1f74cc,'sock':_0x20b69c}),!![];}catch(_0x4f00fc){return console['error'](_0x20462a(0x1eb),_0x4f00fc),![];}}[a0_0xbffaa1(0x1f6)](_0x57e4fa){const _0xb20247=a0_0xbffaa1;this[_0xb20247(0x1d6)]['delete'](_0x57e4fa),super[_0xb20247(0x1e8)](_0x57e4fa);}[a0_0xbffaa1(0x1f4)](){const _0x32ee3e=a0_0xbffaa1,_0x4c19a8=Date[_0x32ee3e(0x1d9)]();for(const [_0x5e5acc,_0x554890]of this[_0x32ee3e(0x1d6)]['entries']()){_0x4c19a8>_0x554890['expiryTime']&&this['removeListener'](_0x5e5acc);}}[a0_0xbffaa1(0x1d8)](){const _0x5c3a69=a0_0xbffaa1;clearInterval(this[_0x5c3a69(0x1dd)]),this[_0x5c3a69(0x1d6)][_0x5c3a69(0x1da)](),this['removeAllListeners']();}}async function kordButtonUpsert(_0x314255,_0x28863c){const _0x517eb0=a0_0xbffaa1;console[_0x517eb0(0x1f2)](_0x517eb0(0x1e3),_0x28863c?.['message']?.[_0x517eb0(0x1e4)]);try{!global[_0x517eb0(0x1e2)]&&(global[_0x517eb0(0x1e2)]=new ButtonHandler());const _0x2840d1=await global[_0x517eb0(0x1e2)][_0x517eb0(0x1f7)](_0x314255,_0x28863c);if(_0x2840d1)return;}catch(_0x450a93){console['error'](_0x517eb0(0x1e1),_0x450a93);}}function createButton({id:_0x38d625,text:_0x3eff35,sessionId:sessionId=null,expiryTime:expiryTime=null}){return{'name':'quick_reply','buttonParamsJson':JSON['stringify']({'display_text':_0x3eff35,'id':_0x38d625,'session':sessionId})};}module[a0_0xbffaa1(0x1de)]={'ButtonHandler':ButtonHandler,'kordButtonUpsert':kordButtonUpsert,'createButton':createButton};